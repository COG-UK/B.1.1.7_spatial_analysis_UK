<?xml version="1.0" standalone="yes"?> 
 
<!-- Generated by BEAUTi v1.10.4 Prerelease #bc6cbd9                         --> 
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         --> 
<!--       Department of Computer Science, University of Auckland and        --> 
<!--       Institute of Evolutionary Biology, University of Edinburgh        --> 
<!--       David Geffen School of Medicine, University of California, Los Angeles--> 
<!--       http://beast.community/                                           --> 
<beast version="1.10.4"> 
	 
	<!-- Insert taxa blocks -->  
	<taxa id="taxa_1">
		<!-- here are all the taxa with coordinates -->
	</taxa> 
	 
	<!-- Insert alignment blocks -->  
	<alignment id="alignment_1" dataType="nucleotide">
	<!-- empty alignment here because we have a fixed tree -->
	</alignment> 
 
	<!-- Insert pattern blocks -->  
	<patterns id="patterns_1" from="1" strip="false">
		<alignment idref="alignment_1"/>
	</patterns> 
	 
	<!-- Insert starting tree blocks -->  
	<empiricalTreeDistributionModel id="treeModel_1" fileName="Empirical_tree_RRW.tre">
		<taxa idref="taxa_1"/>
	</empiricalTreeDistributionModel> 
	 
	<!-- START Multivariate diffusion model                                      --> 
	<multivariateDiffusionModel id="coordinates.diffusionModel"> 
		<precisionMatrix> 
			<matrixParameter id="coordinates.precision"> 
				<parameter id="coordinates.precision.col1" value="0.05 0.002"/> 
				<parameter id="coordinates.precision.col2" value="0.002 0.05"/> 
			</matrixParameter> 
		</precisionMatrix> 
	</multivariateDiffusionModel> 
 
	<multivariateWishartPrior id="coordinates.precisionPrior" df="2"> 
		<scaleMatrix> 
			<matrixParameter> 
				<parameter value="1.0 0.0"/> 
				<parameter value="0.0 1.0"/> 
			</matrixParameter> 
		</scaleMatrix> 
		<data> 
			<parameter idref="coordinates.precision"/> 
		</data> 
	</multivariateWishartPrior> 
 
	<!-- Insert arbitraryBranchRates blocks -->  
	<arbitraryBranchRates id="coordinates.diffusion.branchRates1">
		<treeModel idref="treeModel_1"/>
		<rates> 
			<parameter id="coordinates.diffusion.rates1" lower="0.0"/>
		</rates> 
	</arbitraryBranchRates> 
 
	<!-- Insert distributionLikelihood blocks 1 --> 
	<distributionLikelihood id="coordinates.diffusion.prior1">
		<data> 
			<parameter idref="coordinates.diffusion.rates1"/>
		</data> 
		<distribution> 
			<onePGammaDistributionModel>
				<shape> 
					<parameter value="0.5"/> 
				</shape> 
			</onePGammaDistributionModel> 
		</distribution> 
	</distributionLikelihood> 
 
	<!-- Insert coordinates.traitLikelihood blocks --> 
	<multivariateTraitLikelihood id="coordinates.traitLikelihood1" traitName="coordinates" useTreeLength="true" scaleByTime="true" reportAsMultivariate="true" reciprocalRates="true" integrateInternalTraits="true">
		<multivariateDiffusionModel idref="coordinates.diffusionModel"/> 
		<treeModel idref="treeModel_1"/>		<traitParameter> 
			<parameter id="leaf.coordinates1"/>
		</traitParameter> 
		<conjugateRootPrior> 
			<meanParameter> 
				<parameter value="0.0 0.0"/> 
			</meanParameter> 
			<priorSampleSize> 
				<parameter value="0.000001"/> 
			</priorSampleSize> 
		</conjugateRootPrior> 
		<arbitraryBranchRates idref="coordinates.diffusion.branchRates1"/>
	</multivariateTraitLikelihood> 
	 
	<correlation id="coordinates.correlation" dimension1="1" dimension2="2"> 
		<matrixParameter idref="coordinates.precision"/> 
	</correlation> 
	<matrixInverse id="coordinates.varCovar"> 
		<matrixParameter idref="coordinates.precision"/> 
	</matrixInverse> 
	<!-- Insert continuousDiffusionStatistic blocks 1 --> 
	<continuousDiffusionStatistic id="coordinates.diffusionRate1" greatCircleDistance="true">
		<multivariateTraitLikelihood idref="coordinates.traitLikelihood1"/>
	</continuousDiffusionStatistic> 
 
	<!-- END Multivariate diffusion model                                        --> 
 
	<!-- Define operators                                                        --> 
	<operators id="operators" optimizationSchedule="log"> 
<!--  
		<scaleOperator scaleFactor="0.75" weight="1"> 
			<parameter idref="coordinates.halfDF"/> 
		</scaleOperator> 
 --> 
		<!-- Insert scaleOperator blocks --> 
		<scaleOperator scaleFactor="0.75" weight="30">
			<parameter idref="coordinates.diffusion.rates1"/>
		</scaleOperator> 
		<!-- Insert precisionGibbsOperator blocks --> 
		<precisionGibbsOperator weight="2">
			<multivariateTraitLikelihood idref="coordinates.traitLikelihood1"/>
			<multivariateWishartPrior idref="coordinates.precisionPrior"/> 
		</precisionGibbsOperator> 
	</operators> 
 
	<!-- Define MCMC                                                             --> 
	<mcmc id="mcmc" chainLength="500000000" autoOptimize="true" operatorAnalysis="TreeTime_090221.ops"> 
		<joint id="joint"> 
			<prior id="prior"> 
<!--  
				<exponentialPrior mean="10.0" offset="0.0"> 
					<parameter idref="coordinates.halfDF"/> 
				</exponentialPrior> 
 --> 
				<!-- Insert distributionLikelihood blocks 2 --> 
				<distributionLikelihood idref="coordinates.diffusion.prior1"/>
				<multivariateWishartPrior idref="coordinates.precisionPrior"/> 
			</prior> 
			<likelihood id="likelihood"> 
				<!-- Insert multivariateTraitLikelihood blocks 1 --> 
				<multivariateTraitLikelihood idref="coordinates.traitLikelihood1"/>
			</likelihood> 
		</joint> 
		<operators idref="operators"/> 
 
		<!-- write log to screen                                                     --> 
		<log id="screenLog" logEvery="1000"> 
			<column label="Joint" dp="4" width="12"> 
				<joint idref="joint"/> 
			</column> 
			<column label="Prior" dp="4" width="12"> 
				<prior idref="prior"/> 
			</column> 
			<column label="Likelihood" dp="4" width="12"> 
				<likelihood idref="likelihood"/> 
			</column> 
		</log> 
 
		<!-- write log to file                                                       --> 
		<log id="fileLog" logEvery="10000" fileName="TreeTime_090221.log" overwrite="false"> 
			<joint idref="joint"/> 
			<prior idref="prior"/> 
			<likelihood idref="likelihood"/> 
			<!-- START Multivariate diffusion model                                      --> 
			<matrixParameter idref="coordinates.precision"/> 
			<correlation idref="coordinates.correlation"/> 
			<matrixInverse idref="coordinates.varCovar"/> 
			<!-- Insert continuousDiffusionStatistic blocks 2 --> 
				<continuousDiffusionStatistic idref="coordinates.diffusionRate1"/>
			<!-- Insert multivariateTraitLikelihood blocks 2 --> 
				<multivariateTraitLikelihood idref="coordinates.traitLikelihood1"/>
		</log> 
 
		<!-- write tree log to file                                                  --> 
		<!-- Insert logTree blocks --> 
		<logTree id="treeFileLog1" logEvery="100000" nexusFormat="true" fileName="TreeTime_270221.trees" sortTranslationTable="true">
			<treeModel idref="treeModel_1"/>
			<joint idref="joint"/> 
			<trait name="coordinates" tag="coordinates"> 
				<multivariateTraitLikelihood idref="coordinates.traitLikelihood1"/>
			</trait> 
			<multivariateDiffusionModel idref="coordinates.diffusionModel"/> 
			<trait name="rate" tag="coordinates.rate"> 
				<arbitraryBranchRates idref="coordinates.diffusion.branchRates1"/>
			</trait> 
		</logTree> 
	</mcmc> 
	 
	<report> 
		<property name="timer"> 
			<mcmc idref="mcmc"/> 
		</property> 
	</report> 
	 
</beast> 
